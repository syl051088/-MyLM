# linearR: Linear Regression
<!-- badges: start -->
[![R-CMD-check](https://github.com/syl051088/-MyLM/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/syl051088/-MyLM/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/syl051088/-MyLM/graph/badge.svg)](https://app.codecov.io/gh/syl051088/-MyLM)
<!-- badges: end -->

## Table of Contents

1. [Overview](#overview)
2. [Installation](#installation)
3. [Functions and Usage](#functions-and-usage)
4. [Example](#example)
5. [Output Details](#output-details)
6. [Testing](#testing)

## Overview

The `linearR` package provides a custom implementation of linear regression modeling in R. It includes the primary function `my_lm` for fitting linear models using the normal equations method, along with associated methods for summarizing, printing, and predicting from the fitted models. The package aims to offer an educational insight into the mechanics of linear regression by re-implementing core functionalities typically provided by R's base `lm` function.

### Key Features

- **Custom Linear Model Fitting**: Fit linear regression models using the normal equations.
- **Model Summarization**: Obtain detailed summaries of model parameters and statistics.
- **Prediction Capabilities**: Generate predictions with optional confidence and prediction intervals.
- **Educational Insight**: Understand the inner workings of linear regression modeling.
- **Comprehensive Testing**: High test coverage to ensure reliability and correctness.

## Installation

You can install the `linearR` package from GitHub using the `devtools` package:

```R
# Install devtools if you haven't already
install.packages("devtools")

# Install linearR from GitHub
devtools::install_github("syl051088/linearR")
```

Alternatively, if the package is available on CRAN, you can install it directly:

```R
install.packages("linearR")
```

## Functions and Usage

The package includes the following primary functions:

1. **`my_lm(formula, data)`**: Fits a linear regression model.
2. **`summary_linearR(object)`**: Provides a detailed summary of a `linearR` model object.
3. **`print_summary_linearR(object)`**: Prints the summary of a `linearR` model object.
4. **`predict_linearR(object, newdata, interval, level)`**: Generates predictions from a `linearR` model object.

### 1. `my_lm`

**Description**: Fits a linear regression model using the normal equations method.

**Usage**:

```R
fit <- my_lm(formula, data)
```

**Arguments**:

- `formula`: An object of class `"formula"` describing the model to be fitted.
- `data`: A data frame containing the variables in the model.

**Returns**: An object of class `"linearR"` containing model fit results.

### 2. `summary_linearR`

**Description**: Provides a detailed summary of a `linearR` object, including coefficients, standard errors, t-values, p-values, and model statistics.

**Usage**:

```R
summary_fit <- summary_linearR(fit)
```

**Arguments**:

- `object`: An object of class `"linearR"`.

**Returns**: An object of class `"summary_linearR"` containing summary information.

### 3. `print_summary_linearR`

**Description**: Prints the summary of a `linearR` object generated by `summary_linearR`.

**Usage**:

```R
print_summary_linearR(summary_fit)
```

**Arguments**:

- `x`: An object of class `"summary_linearR"`.

**Returns**: Invisibly returns `x`.

### 4. `predict_linearR`

**Description**: Generates predictions from a `linearR` object, with options for confidence and prediction intervals.

**Usage**:

```R
predictions <- predict_linearR(fit, newdata, interval = "none", level = 0.95)
```

**Arguments**:

- `object`: An object of class `"linearR"`.
- `newdata`: Optional data frame for which to make predictions.
- `interval`: Type of interval calculation (`"none"`, `"confidence"`, or `"prediction"`).
- `level`: Confidence level for the intervals (default is `0.95`).

**Returns**: A vector of predicted values or a matrix with columns for the fit and interval bounds.

## Example

Here's a basic example demonstrating how to use the `linearR` package with the `mtcars` dataset:

```R
# Load the package
library(linearR)

# Load example data
data(mtcars)

# Fit a linear regression model
fit <- my_lm(mpg ~ wt + cyl, data = mtcars)

# Summarize the model
summary_fit <- summary_linearR(fit)

# Print the summary
print_summary_linearR(summary_fit)

# Create new data for prediction
new_data <- data.frame(
  wt = c(2.5, 3.0),
  cyl = c(6, 8)
)

# Generate predictions
predictions <- predict_linearR(fit, newdata = new_data)

# Print predictions
print(predictions)
```

**Output**:

```
Call:
my_lm(formula = mpg ~ wt + cyl, data = mtcars)

Residuals:
Degrees of Freedom: 29

Coefficients:
            Estimate Std. Error   t value     Pr(>|t|)
(Intercept) 39.68626   1.715198 23.140760 2.289109e-21
wt          -3.19097   0.757887 -4.210644 2.309051e-04
cyl         -1.50779   0.415944 -3.626799 1.091259e-03

Residual standard error: 2.557 on 29 degrees of freedom
Multiple R-squared: 0.8302
Adjusted R-squared: 0.8190

        fit
1 24.16875
2 17.17355
```

## Output Details

### Model Summary (`summary_linearR`)

- **Coefficients**: Estimates of the regression coefficients.
- **Standard Errors**: Standard errors of the estimates.
- **t-values**: t-statistics for hypothesis testing.
- **p-values**: p-values for the significance of each coefficient.
- **Residual Standard Error**: Estimate of the standard deviation of the error term.
- **R-squared**: Proportion of variance explained by the model.
- **Adjusted R-squared**: Adjusted for the number of predictors.

### Predictions (`predict_linearR`)

- **Point Predictions**: Estimated values of the response variable.
- **Confidence Intervals**: Interval estimates for the mean response.
- **Prediction Intervals**: Interval estimates for individual predictions.

**Example with Intervals**:

```R
# Prediction with confidence intervals
pred_ci <- predict_linearR(fit, newdata = new_data, interval = "confidence")

# Prediction with prediction intervals
pred_pi <- predict_linearR(fit, newdata = new_data, interval = "prediction")

# Print results
print(pred_ci)
print(pred_pi)
```

**Output**:

```
        fit      lwr      upr
1 24.16875 23.14128 25.19623
2 17.17355 16.20352 18.14358

        fit      lwr      upr
1 24.16875 18.91454 29.42295
2 17.17355 11.95248 22.39462
```

## Testing

The `linearR` package includes comprehensive unit tests to ensure reliability and correctness. The tests cover:

- **Model Fitting**: Correctness of coefficient estimates, residuals, and fitted values.
- **Edge Cases**: Handling of singular matrices, missing data, and insufficient degrees of freedom.
- **Prediction Functionality**: Accuracy of predictions and intervals, handling of new data with unseen factor levels.
- **Statistical Measures**: Validation of R-squared, adjusted R-squared, and variance estimates.
- **Error Handling**: Proper error messages for invalid inputs and conditions.

### Running Tests

To run the tests, use the `testthat` package:

```R
library(testthat)
test_package("linearR")
```

### Code Coverage

The package aims for high code coverage to ensure all aspects of the code are tested. Coverage reports can be generated using the `covr` package:

```R
library(covr)
report()
```

**Note**: The package only achieves 98.35% code coverage.

### Example of a Unit Test

```R
test_that("my_lm produces correct coefficients", {
  fit_my <- my_lm(mpg ~ wt + cyl, data = mtcars)
  fit_lm <- lm(mpg ~ wt + cyl, data = mtcars)

  expect_equal(as.vector(fit_my$coefficients), as.vector(coef(fit_lm)))
})
```

**Description**: This test checks that the `my_lm` function produces coefficient estimates identical to those from the base R `lm` function.

## Contributing

Contributions are welcome! If you find a bug or have a feature request, please open an issue on GitHub. Pull requests for enhancements, additional tests, or documentation improvements are appreciated.

## License

This package is licensed under the MIT License. See the `LICENSE` file for details.

---

**Disclaimer**: This package is intended for educational purposes to demonstrate the implementation of linear regression from scratch. For production use, consider using the base R `lm` function or other optimized packages.
